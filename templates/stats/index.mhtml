<%args>
    $logged_in => 0
    $user_results => 1
</%args>

<%perl>

my %prediction_image = (
    up   => sprintf('<img src="%s" class="small_arrow">', $c->cdn('images/up_active.gif')),
    down => sprintf('<img src="%s" class="small_arrow">', $c->cdn('images/down_active.gif')),
    none => '-',
);
</%perl>

%   unless ($logged_in) {
<div class="login_warning error">
    <div>Login to view your results</div>
</div>
%   }

<h1>Statistics</h1>

<div id="result-accordion">
%#    <div class="table-head">
%#        <div class="period">Prediction Period</div>
%#        <div class="quantity">Guesses</div>
%#        <div class="pc">Win %</div>
%#        <div class="points">Points</div>
%#    </div>
%   for my $period (sort {$b <=> $a} keys %$user_results) {
    <div class="accordion-handle">
        <div class="period"  ><% $user_results->{$period}->{date}     %></div>
        <div class="quantity">Guesses: <span class="boxed"><% $user_results->{$period}->{quantity} %></span></div>
        <div class="pc"      >Correct %:<span class="boxed"><% $user_results->{$period}->{pc}       %></span></div>
        <div class="points"  >Points: <span class="boxed"><% $user_results->{$period}->{points}   %></span></div>
    </div>
    <div class="period-results">
        <div class="period-results-head">
            <div class="ticker">Ticker</div>
            <div class="prediction">You Guessed</div>
            <div class="actual">Market Move</div>
            <div class="correct">Result</div>
        </div>
        <div class="period-results-body">
%       for my $prediction (@{ $user_results->{$period}->{data} }) {
            <div class="period-results-row">
                <div class="ticker"><% $prediction->{ticker} %></div>
                <div class="prediction"><% $prediction->{direction} %></div>
                <div class="actual"><% $prediction->{actual} %></div>
                <div class="correct"><% $prediction->{result} %></div>
            </div>
%       }
        </div>
    </div>
%   }
</div>



<script>
    $("li.date").click(function() {
        $("li.date").removeClass("current");
        $(this).addClass("current");
    });

</script>
