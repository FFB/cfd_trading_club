<%once>
    use JSON::XS;
</%once>
<%args>
    $logged_in   => 0
    $login_error => 0
    $username    => undef
    $path        => undef
    $admin       => 0
</%args>
<html>

<head>
<title>CFD Trading Club</title>
    <link rel="stylesheet" type="text/css" href="<% $c->cdn('css/autohandler.css') %>" />
    <link rel='stylesheet' type="text/css" href="<% $c->cdn('css/registration.css') %>" />
    <link rel='stylesheet' type="text/css" href="<% $c->cdn('css/predict.css') %>" />
    <link rel='stylesheet' type="text/css" href="<% $c->cdn('css/predictor.css') %>" />
    <link rel='stylesheet' type="text/css" href="<% $c->cdn('css/ui-lightness/jquery-ui-1.8.17.custom.css') %>" />
    <link rel="shortcut icon" href="<% $c->cdn('images/favico.ico') %>">
    <script type="text/javascript" src="<% $c->cdn('js/jquery-1.7.1.min.js') %>"></script>
    <script type="text/javascript" src="<% $c->cdn('js/jquery-ui-1.8.17.custom.min.js') %>"></script>
</head>

<body id="body">
    <div id="header">
        <img src="<% $c->cdn('images/head.png') %>">
        <div id="login_b">
            <div id="login_content">
                <form id="<% $logged_in ? 'logout' : 'login' %>-form"
                      class="<% $login_error ? 'hidden' : ''%>"
                      action="<% $logged_in ? 'logout' : 'login' %>"
                      method="POST"
                >
                    <input type="hidden" name="path" value="<% $path %>">
%   if ($logged_in) {
                    <span class="welcome">Welcome, <% $username %>!</span>
                    <input type="submit" class="button" value="Logout">
%   }
%   else {
                    <input type="button"   class="button" value="Join Now">
                    <input type="text"     class="credential" name="username" placeholder="Username">
                    <input type="password" class="credential" name="password" placeholder="Password">
                    <input type="submit"   class="button" value="Login">
%   }
                </form>

                <div id="login-error-box" class="error <% $login_error ? '' : 'hidden' %>">
                    <span class="alert">
                        Sorry, incorrect username or password.
                        <a class="reset">Try again</a>
                    </span>
                </div>
            </div><!--login_content-->
        </div><!--login_b-->
    </div><!--header-->

    <div id="navbar">
        <ul id=<% $path ||= 'home' %>>
            <li id="nav-home"><a href="/">Home</a></li>
            <li id="nav-about"><a href="/about">About Us</a></li>
            <li id="nav-register"><a href="/register">Register</a></li>
            <li id="nav-competition"><a href="/competition">Competiion</a></li>
            <li id="nav-predict"><a href="/predict">Predict</a></li>
            <li id="nav-stats"><a href="/stats">Statistics</a></li>
            <li id="nav-links"><a href="/links">Links</a></li>
%   if ($admin) {
            <li id="nav-admin"><a href="/admin">Admin</a></li>
%   }
%#              <li class="last"></li>
        </ul>
    </div> <!-- navbar -->

    <div id="marquee">
        <marquee behavior="scroll" direction="left">Hi Zane! Breaking news and stock info goes here...This is not really that exciting.</marquee>
    </div>

    <div id="content">
% use Data::Dump qw/dump/; #for debugging purposes
        <div id="left_sect">
            <div align="center">
                <img src="<% $c->cdn('images/left_100x80.jpg') %>">
            </div>
            <br />
            <img src="<% $c->cdn('images/heading.png') %>">
            <br /><p>Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here.</p>
        </div>
        <div id="center_sect">
            <div align="center">
                <img src="<% $c->cdn('images/center_650x83.jpg') %>">
            </div>
            <br />
%#          <img src="<% $c->cdn('images/heading.png') %>">
% $m->call_next;
            <p>Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here. Lorem ipsum dolor amet. Stuff goes here and here and here. More stuff goes here and here and here.</p>
        </div>
        <div id="recent_posts">
            <img src="<% $c->cdn('images/recent_posts.png') %>">
            <br />
            <p>trolol123: Omg yea trading is cool and shit</p>
            <p>n00b321: Hoyyy i just looove to buy gold stocks</p>
            <p>sexylady69: B==8</p>
            <br />See more...
        </div>
    </div>

%#    <div id="bottom">
%#    </div>

<script type="text/javascript" src="<% $c->cdn('js/autohandler.js') %>"></script>
<script>
    //$("#login_b").on("submit", "#login-form", function() {
    //    var $username = $(this).find("input[name=username]").val();
    //    var $password = $(this).find("input[name=password]").val();
    //    $.ajax({
    //        type:       "POST",
    //        url:        "login",
    //        dataType:   "html",
    //        cache:      false,
    //        data:       {
    //            username: $username,
    //            password: $password,
    //            path:     window.location.pathname
    //        },
    //        success: function(data) {
    //            process_login(data);
    //        }
    //    });
    //    return false;
    //});

    $("#login_b").on("click", "#login-error-box a", function() {
        $("#login-error-box").addClass("hidden");
        $("#login_b form").removeClass("hidden");
    });
</script>

<& SELF:load_script &>

</body>


</html>

%# Default script if nothing implemented in child component
<%method load_script>
</%method>

